<!DOCTYPE HTML>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="/static/css/style.css">
    <link rel="Stylesheet" type="text/css" href="/static/css/tango.css">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="alternate" type="application/atom+xml" href="atom.xml" title="Atom feed">
    <title>MyBatis插入记录获取自增长id - </title>
    <meta name="keywords" content=""/>
    <meta name="description" content=""/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  </head>

  <body>
    <div id="container">
      
<div id="header">
  <div class="post-nav"><a href="/">Home</a>&nbsp;&#187;&nbsp;<a href="/#MyBatis">MyBatis</a>&nbsp;&#187;&nbsp;MyBatis插入记录获取自增长id
    <span class="updated">Page Updated&nbsp;
      2017年7月20日11:23:32
    </span></div>
</div>
<div class="clearfix"></div>

<div class="page_title">MyBatis插入记录获取自增长id</div>

  <p>需求：使用MyBatis往MySQL数据库中插入一条记录，需要返回这条记录的自增ID值<br />
步骤：<br />
1. 在mapper中指定keyProperty属性</p>
<div class="hlcode"><pre>    <span class="nt">&lt;insert</span> <span class="na">id=</span><span class="s">&quot;insert&quot;</span> <span class="na">parameterType=</span><span class="s">&quot;iguard.entity.chunyu.CYDoctor&quot;</span> <span class="na">useGeneratedKeys=</span><span class="s">&quot;true&quot;</span> <span class="na">keyProperty=</span><span class="s">&quot;id&quot;</span> <span class="nt">&gt;</span>
        insert into cydoctors (Name, Title, Images, Clinic, Hospital, ChunYuID) 
        values (#{name,jdbcType=VARCHAR}, #{title,jdbcType=VARCHAR}, #{images,jdbcType=VARCHAR}, 
        #{clinic,jdbcType=VARCHAR}, #{hospital,jdbcType=VARCHAR}, #{chunyuId,jdbcType=VARCHAR})
    <span class="nt">&lt;/insert&gt;</span>

如上所示，在insert中指定keyProperty=&quot;id&quot;，其中id为插入的CYDoctor对象的主键属性。
</pre></div>


<ol>
<li>
<p>CYDocotr类的定义</p>
<div class="hlcode"><pre><span class="n">public</span> <span class="n">class</span> <span class="n">CYDoctor</span> <span class="n">implements</span> <span class="n">Serializable</span> <span class="p">{</span>
     <span class="n">private</span> <span class="n">Integer</span> <span class="n">id</span><span class="p">;</span>
     <span class="n">private</span> <span class="n">String</span> <span class="n">name</span><span class="p">;</span>   
     <span class="c1">// ...其它属性省略             </span>
<span class="p">}</span>
</pre></div>


</li>
<li>
<p>CYDoctorMapper接口的定义</p>
<div class="hlcode"><pre><span class="n">public</span> <span class="n">interface</span> <span class="n">CYDoctorMapper</span> <span class="p">{</span>
     <span class="n">Integer</span> <span class="n">insert</span><span class="p">(</span><span class="n">CYDoctor</span> <span class="n">record</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>


<ol>
<li>
<p>service层的调用</p>
<p>public int saveDoctorInfo(CYDoctor doctor)<br />
     int num = doctorMapper.insert(doctor);<br />
     Integer doctorId = doctor.getId();<br />
     // ...省略其它代码<br />
}</p>
</li>
</ol>
</li>
<li>
<p>注意点</p>
<ul>
<li>MyBatis Mapper文件中，useGeneratedKeys和keyProperty必须添加，而且keyProperty一定和java对象的属性名称相同，而不是表的字段名</li>
<li>Mapper的接口中的insert方法，传递的参数必须是java对象，不能是某个参数。</li>
</ul>
</li>
</ol>
    </div>
    <div id="footer">
      <span>
        <p>Copyright © 2017 .
        Powered by <a href="http://simiki.org/" target="_blank">Simiki</a>.</p>
        <p>Site Generated 2017-07-24 14:48:39</p>
      </span>
    </div>

    
    
  </body>
</html>